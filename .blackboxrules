# Blackbox.ai Rules for Estately Project

## Project Overview
Estately is a comprehensive real estate management platform built with React/TypeScript frontend and Appwrite backend. This project manages property listings, contracts, documents, forms, user profiles, and project workflows.

## Code Quality Standards

### 1. TypeScript Best Practices
- **Strict Type Checking**: Always use strict TypeScript with no `any` types except in unavoidable cases
- **Interface Definitions**: Define proper interfaces for all data structures, especially Appwrite collections
- **Type Safety**: Ensure all functions have proper return types and parameter types
- **Generic Types**: Use TypeScript generics for reusable components and utilities

### 2. React Component Guidelines
- **Functional Components**: Prefer functional components with hooks over class components
- **Custom Hooks**: Extract reusable logic into custom hooks (e.g., `useAuth`, `useProjects`)
- **Component Naming**: Use PascalCase for component names, camelCase for instances
- **Props Interface**: Define props interfaces for all components that accept props

### 3. File Organization
- **Feature-based Structure**: Organize files by feature/domain (components/, services/, views/)
- **Index Files**: Use index.ts files for clean imports
- **Consistent Naming**: Use kebab-case for file names, PascalCase for components
- **Avoid Deep Nesting**: Keep folder depth to maximum 3 levels

## Appwrite Integration Rules

### 1. Database Operations
- **Service Layer**: Use dedicated service files (e.g., `services/appwrite.ts`, `services/projectService.ts`)
- **Error Handling**: Implement proper error handling for all database operations
- **Query Optimization**: Use appropriate queries and limits to avoid performance issues
- **Data Validation**: Validate data before sending to Appwrite

### 2. Collection Management
- **Consistent IDs**: Use environment variables for collection IDs
- **Relationship Handling**: Properly handle relationships between collections
- **Permission Management**: Set appropriate permissions for collections and documents
- **Indexing**: Ensure proper indexing for frequently queried fields

### 3. Storage Operations
- **File Validation**: Validate file types and sizes before upload
- **Secure URLs**: Use proper file preview URLs with appropriate permissions
- **Cleanup**: Implement proper cleanup of unused files
- **Bucket Organization**: Organize files in appropriate buckets

## Security Guidelines

### 1. Authentication & Authorization
- **Secure Sessions**: Properly handle user sessions and logout
- **Role-based Access**: Implement proper role-based access control
- **API Key Management**: Never expose API keys in client-side code
- **Input Validation**: Validate all user inputs on both client and server

### 2. Data Protection
- **Sensitive Data**: Never store sensitive information in local storage
- **Encryption**: Use appropriate encryption for sensitive data
- **Audit Trail**: Maintain audit trails for important operations
- **Data Sanitization**: Sanitize data before display

## Development Workflow

### 1. Git Practices
- **Branch Naming**: Use descriptive branch names (feature/, bugfix/, hotfix/)
- **Commit Messages**: Write clear, descriptive commit messages
- **Pull Requests**: Create detailed PR descriptions with testing instructions
- **Code Reviews**: Require code reviews for all changes

### 2. Testing Requirements
- **Unit Tests**: Write unit tests for utility functions and hooks
- **Integration Tests**: Test Appwrite service integrations
- **Component Tests**: Test critical UI components
- **E2E Tests**: Test complete user workflows

### 3. Documentation
- **Code Comments**: Add JSDoc comments for complex functions
- **README Updates**: Keep README and documentation current
- **API Documentation**: Document custom APIs and services
- **Changelog**: Maintain a changelog for releases

## Performance Optimization

### 1. React Performance
- **Memoization**: Use React.memo, useMemo, and useCallback appropriately
- **Lazy Loading**: Implement code splitting and lazy loading for routes
- **Virtual Scrolling**: Use virtual scrolling for large lists
- **Image Optimization**: Optimize images and use appropriate formats

### 2. Appwrite Performance
- **Query Limits**: Set appropriate limits on database queries
- **Pagination**: Implement proper pagination for large datasets
- **Caching**: Implement client-side caching where appropriate
- **Batch Operations**: Use batch operations for multiple updates

## Error Handling & Logging

### 1. Error Boundaries
- **React Error Boundaries**: Implement error boundaries for component trees
- **Graceful Degradation**: Handle errors gracefully without breaking the app
- **User Feedback**: Provide clear error messages to users
- **Error Reporting**: Log errors for debugging and monitoring

### 2. Logging Strategy
- **Structured Logging**: Use structured logging with consistent formats
- **Log Levels**: Use appropriate log levels (debug, info, warn, error)
- **Sensitive Data**: Never log sensitive information
- **Performance**: Ensure logging doesn't impact performance

## Accessibility & UX

### 1. Accessibility Standards
- **WCAG Compliance**: Follow WCAG 2.1 AA standards
- **Keyboard Navigation**: Ensure all interactions work with keyboard
- **Screen Readers**: Provide proper ARIA labels and descriptions
- **Color Contrast**: Maintain proper color contrast ratios

### 2. User Experience
- **Loading States**: Show appropriate loading indicators
- **Error States**: Handle and display errors gracefully
- **Responsive Design**: Ensure mobile-first responsive design
- **Progressive Enhancement**: Build with progressive enhancement

## Environment & Deployment

### 1. Environment Variables
- **Naming Convention**: Use `VITE_` prefix for client-side variables
- **Validation**: Validate required environment variables on startup
- **Documentation**: Document all required environment variables
- **Security**: Never commit sensitive environment variables

### 2. Build & Deployment
- **Build Optimization**: Optimize builds for production
- **Asset Management**: Properly manage static assets
- **CDN Integration**: Use CDNs for static assets when appropriate
- **Monitoring**: Implement monitoring and alerting

## Code Review Checklist

### Before Submitting PR:
- [ ] TypeScript compilation passes with no errors
- [ ] All tests pass
- [ ] Code follows established patterns and conventions
- [ ] No console.log statements in production code
- [ ] Proper error handling implemented
- [ ] Documentation updated if needed
- [ ] Security considerations addressed

### Code Review Focus Areas:
- [ ] Code readability and maintainability
- [ ] Performance implications
- [ ] Security vulnerabilities
- [ ] Test coverage
- [ ] Type safety
- [ ] Appwrite integration best practices

## Project-Specific Rules

### 1. Form Management
- **Form Validation**: Use proper validation for all forms
- **State Management**: Handle form state appropriately
- **File Uploads**: Handle file uploads with progress indicators
- **Data Persistence**: Save form drafts appropriately

### 2. Document Management
- **File Types**: Support appropriate document formats
- **Preview Generation**: Generate previews for supported formats
- **Version Control**: Handle document versioning
- **Access Control**: Implement proper document access controls

### 3. Project Management
- **Workflow States**: Define clear project workflow states
- **Task Assignment**: Handle task assignment and tracking
- **Notifications**: Implement appropriate notifications
- **Audit Trail**: Maintain audit trails for project changes

### 4. User Management
- **Profile Management**: Handle user profiles and preferences
- **Role Management**: Implement proper role-based permissions
- **Team Collaboration**: Support team-based workflows
- **Communication**: Handle user communication features

## Tooling & Dependencies

### 1. Package Management
- **Dependency Updates**: Keep dependencies updated and secure
- **Bundle Analysis**: Monitor bundle sizes and dependencies
- **License Compliance**: Ensure license compliance for all dependencies
- **Security Audits**: Run regular security audits

### 2. Development Tools
- **ESLint**: Follow established ESLint rules
- **Prettier**: Use Prettier for consistent code formatting
- **TypeScript**: Maintain strict TypeScript configuration
- **Testing Framework**: Use established testing frameworks

## Monitoring & Maintenance

### 1. Performance Monitoring
- **Core Web Vitals**: Monitor and optimize Core Web Vitals
- **Error Tracking**: Implement error tracking and alerting
- **Performance Budgets**: Set and monitor performance budgets
- **User Analytics**: Track user behavior and performance

### 2. Maintenance Tasks
- **Regular Updates**: Keep dependencies and systems updated
- **Database Maintenance**: Perform regular database maintenance
- **Backup Verification**: Regularly test backup and recovery procedures
- **Security Patches**: Apply security patches promptly

---

## Rule Enforcement

These rules are enforced through:
- **Automated Checks**: ESLint, TypeScript, and testing in CI/CD
- **Code Reviews**: Manual review for complex changes
- **Documentation**: Regular review and updates of these rules
- **Training**: Team training on best practices and standards

## Contact & Support

For questions about these rules or suggestions for improvements:
- Create an issue in the project repository
- Discuss in team meetings
- Contact the development team lead

---

*Last Updated: January 31, 2025*
*Version: 1.0*
*Maintained by: Development Team*
